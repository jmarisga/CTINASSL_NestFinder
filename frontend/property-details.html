<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <title>Nest Finder - Property Detail Page</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">


    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-villa-agency.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/animate.css">
    <link rel="stylesheet"href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
    <style>
      /* Make the schedule CTA span the card width */
      .info-table .main-button a {
        display: block;
        width: 100%;
        padding: 14px 0;
        border-radius: 28px;
      }
    </style>

  </head>

<body>

  <!-- ***** Preloader Start ***** -->
  <div id="js-preloader" class="js-preloader">
    <div class="preloader-inner">
      <span class="dot"></span>
      <div class="dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>
  <!-- ***** Preloader End ***** -->

  <div class="sub-header">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-8">
          <ul class="info">
            <li><i class="fa fa-envelope"></i> info@nestfinder.com</li>
            <li><i class="fa fa-map"></i> S4F, New City Hall Bldg, Brgy. Poblacion, San Pedro, Laguna </li>
          </ul>
        </div>
        <div class="col-lg-4 col-md-4">
          <ul class="social-links">
            <li><a href="#"><i class="fab fa-facebook"></i></a></li>
            <li><a href="https://x.com/minthu" target="_blank"><i class="fab fa-twitter"></i></a></li>
            <li><a href="#"><i class="fab fa-linkedin"></i></a></li>
            <li><a href="#"><i class="fab fa-instagram"></i></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- ***** Header Area Start ***** -->
  <header class="header-area header-sticky">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="main-nav">
                    <!-- ***** Logo Start ***** -->
                    <a href="index.html" class="logo">
                        <h1>NEST<span style="margin-left: 8px;">FINDER</span></h1>
                    </a>
                    <!-- ***** Logo End ***** -->
                    <!-- ***** Menu Start ***** -->
                    <ul class="nav">
                      <li><a href="index.html">Home</a></li>
                      <li><a href="properties.html">Properties</a></li>
                      <li><a href="property-details.html" class="active">Property Details</a></li>
                      <li><a href="contact.html">Contact Us</a></li>
                      <li id="nav-login-item"><a href="#" id="nav-login-link">Login</a></li>
                      <li id="nav-register-item"><a href="#" id="nav-register-link">Register</a></li>
                      <li id="nav-logout-item" style="display:none;"><a href="#" id="nav-logout-link">Logout</a></li>
                      <li><a href="#" id="nav-schedule-link"><i class="fa fa-calendar"></i> Schedule a visit</a></li>
                  </ul>   
                    <a class='menu-trigger'>
                        <span>Menu</span>
                    </a>
                    <!-- ***** Menu End ***** -->
                </nav>
            </div>
        </div>
    </div>
  </header>
  <!-- ***** Header Area End ***** -->

  <!-- Auth & Schedule Modals -->
  <div class="modal fade" id="authModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="authModalTitle">Login</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="auth-form">
            <div class="mb-3" id="auth-name-group" style="display:none;">
              <label for="auth-name" class="form-label">Full Name</label>
              <input type="text" class="form-control" id="auth-name" placeholder="Your full name" required>
            </div>
            <div class="mb-3">
              <label for="auth-email" class="form-label">Email address</label>
              <input type="email" class="form-control" id="auth-email" placeholder="you@example.com" required>
            </div>
            <div class="mb-3">
              <label for="auth-password" class="form-label">Password</label>
              <input type="password" class="form-control" id="auth-password" placeholder="********" minlength="8" required>
            </div>
            <div class="alert alert-danger py-2 px-3" id="auth-error" style="display:none;font-size:0.85rem;"></div>
            <button type="submit" class="btn btn-primary w-100" id="auth-submit-btn">Login</button>
            <p class="mt-3 mb-0 text-center" id="auth-toggle-text" style="font-size:0.9rem;">
              Don't have an account? <a href="#" id="auth-toggle-link">Register</a>
            </p>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Feedback Modal: Login/Register Success -->
  <div class="modal fade" id="authFeedbackModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content feedback-modal-content">
        <div class="modal-body" id="auth-feedback-body" style="text-align: center; padding: 40px 30px;">
          <h5 id="auth-feedback-title" style="margin-bottom: 15px; font-size: 1.3rem; font-weight: 700; color: #333;">Success</h5>
          <p id="auth-feedback-message" style="margin: 0; font-size: 1.1rem; color: #666;">You are now logged in.</p>
        </div>
        <div class="modal-footer feedback-modal-footer">
          <button type="button" class="btn btn-primary feedback-btn" data-bs-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Logout Confirmation Modal -->
  <div class="modal fade" id="logoutConfirmModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content feedback-modal-content">
        <div class="modal-body" style="text-align: center; padding: 40px 30px;">
          <h5 style="margin-bottom: 15px; font-size: 1.3rem; font-weight: 700; color: #333;">Confirm Logout</h5>
          <p style="margin: 0; font-size: 1.1rem; color: #666;">Are you sure you want to log out?</p>
        </div>
        <div class="modal-footer feedback-modal-footer" style="justify-content: center; gap: 10px;">
          <button type="button" class="btn btn-secondary feedback-btn" data-bs-dismiss="modal" id="logout-confirm-no">Cancel</button>
          <button type="button" class="btn btn-primary feedback-btn" id="logout-confirm-yes">Logout</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="scheduleModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Schedule a Visit</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="schedule-form">
            <div class="mb-3">
              <label for="schedule-property-name" class="form-label">Selected Property</label>
              <input type="text" class="form-control" id="schedule-property-name" readonly>
            </div>
            <div class="mb-3">
              <label for="schedule-date" class="form-label">Preferred Date & Time</label>
              <input type="datetime-local" class="form-control" id="schedule-date" required>
            </div>
            <div class="mb-3">
              <label for="schedule-notes" class="form-label">Notes (optional)</label>
              <textarea class="form-control" id="schedule-notes" rows="3" placeholder="Anything specific you would like to see or know?"></textarea>
            </div>
            <div class="alert alert-danger py-2 px-3" id="schedule-error" style="display:none;font-size:0.85rem;"></div>
            <div class="alert alert-success py-2 px-3" id="schedule-success" style="display:none;font-size:0.85rem;"></div>
            <button type="submit" class="btn btn-primary w-100">Confirm Visit</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="page-heading header-text">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <span class="breadcrumb"><a href="#">Properties</a>  /   Property Details</span>
          <h3>Single Property</h3>
        </div>
      </div>
    </div>
  </div>

  <div class="single-property section">
    <div class="container">
      <div class="row">
        <div class="col-lg-8">
          <div class="main-image">
            <img id="property-image" src="assets/images/single-property.jpg">
          </div>
          
          <!-- Property Details Card -->
          <div class="property-details-card">
            <ul>
              <li>
                <img src="assets/images/info-icon-01.png">
                <h4 id="property-bedrooms">8</h4>
                <span>Bedrooms</span>
              </li>
              <li>
                <img src="assets/images/info-icon-02.png">
                <h4 id="property-bathrooms">8</h4>
                <span>Bathrooms</span>
              </li>
              <li>
                <img src="assets/images/info-icon-03.png">
                <h4 id="property-area-display">545m2</h4>
                <span>Area</span>
              </li>
              <li>
                <img src="assets/images/info-icon-04.png">
                <h4 id="property-floor">3</h4>
                <span>Floor</span>
              </li>
              <li>
                <img src="assets/images/info-icon-01.png">
                <h4 id="property-parking">6</h4>
                <span>Parking</span>
              </li>
            </ul>
          </div>
          
          <div class="main-content">
            <span id="property-category" class="category">Apartment</span>
            <h4 id="property-price-display" class="property-price">2,264,000</h4>
            <h4 id="property-name">24 New Street Miami, OR 24560</h4>
            <p id="property-description">Get <strong>the best property finder</strong> platform for your real estate needs. Nest Finder provides you with <a href="https://www.google.com/search?q=best+real+estate+platforms" target="_blank">comprehensive property listings</a> and expert guidance. Discover your perfect home with our easy-to-use search and scheduling tools.
            
            <br><br>When you're looking for the perfect property, Nest Finder makes it easy to browse, compare, and schedule visits. Our platform helps you find exactly what you're looking for with detailed listings, professional photos, and comprehensive property information.</p>
          </div> 
          <div class="accordion" id="accordionExample">
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingOne">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                  Best useful links ?
                </button>
              </h2>
              <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                Discover helpful resources to guide your  <strong>property search</strong> in Laguna City. Whether you're exploring apartments, houses, or villa houses, these links connect you to trusted tools, updated listings, and tips for choosing the right home. Use them to stay informed and make smarter decisions during your search.                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingTwo">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                  How does this work ?
                </button>
              </h2>
              <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                Nest Finder makes property hunting simple. Just browse through the listings, use filters to narrow down your options, and check each property’s details. If something interests you, you can schedule a visit or contact the owner/agent directly. Everything is designed to help you find the right place faster and easier.                 </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingThree">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                  Why is Nest Finder the best ?
                </button>
              </h2>
              <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
              <div class="accordion-body">
                Nest Finder focuses on properties specifically in Laguna City, making your search more accurate and relevant. We offer organized categories, clear property details, and easy scheduling for site visits. Our goal is to give users a smooth, hassle-free experience—helping you find the perfect home.   </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-4">
          <div class="info-table">
            <ul>
              <li>
                <img src="assets/images/info-icon-01.png" alt="" style="max-width: 52px;">
                <h4 id="property-area">450 m2<br><span>Total Flat Space</span></h4>
              </li>
              <li>
                <img src="assets/images/info-icon-02.png" alt="" style="max-width: 52px;">
                <h4>Contact Agents<br><span>Contract Ready</span></h4>
              </li>
              <li>
                <img src="assets/images/info-icon-03.png" alt="" style="max-width: 52px;">
                <h4>Bank/Cash<br><span>Payment Process</span></h4>
              </li>
              <li>
                <img src="assets/images/info-icon-04.png" alt="" style="max-width: 52px;">
                <h4>Safety<br><span>24/7 Under Control</span></h4>
              </li>
            </ul>
          </div>
          <div class="main-button schedule-visit" style="margin-top: 30px;">
            <a href="#" id="schedule-visit-btn" aria-label="Schedule a visit"><i class="fa fa-calendar"></i> Schedule a Visit</a>
          </div>
        </div>
      </div>
    </div>
  </div>
 <br>


  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>
  <script src="assets/js/counter.js"></script>
  <script src="assets/js/custom.js"></script>
  <script src="assets/js/property-data.js"></script>
  <script src="assets/js/auth.js"></script>

  <div class="modal fade" id="authFeedbackModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content feedback-modal-content">
        <div class="modal-body" id="auth-feedback-body" style="text-align: center; padding: 40px 30px;">
          <h5 id="auth-feedback-title" style="margin-bottom: 15px; font-size: 1.3rem; font-weight: 700; color: #333;">Success</h5>
          <p id="auth-feedback-message" style="margin: 0; font-size: 1.1rem; color: #666;">You are now logged in.</p>
        </div>
        <div class="modal-footer feedback-modal-footer">
          <button type="button" class="btn btn-primary feedback-btn" data-bs-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="logoutConfirmModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content feedback-modal-content">
        <div class="modal-body" style="text-align: center; padding: 40px 30px;">
          <h5 style="margin-bottom: 15px; font-size: 1.3rem; font-weight: 700; color: #333;">Confirm Logout</h5>
          <p style="margin: 0; font-size: 1.1rem; color: #666;">Are you sure you want to log out?</p>
        </div>
        <div class="modal-footer feedback-modal-footer" style="justify-content: center; gap: 10px;">
          <button type="button" class="btn btn-secondary feedback-btn" data-bs-dismiss="modal" id="logout-confirm-no">Cancel</button>
          <button type="button" class="btn btn-primary feedback-btn" id="logout-confirm-yes">Logout</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Load property details and wire auth/scheduling against visits API
    document.addEventListener('DOMContentLoaded', async function() {
      const params = new URLSearchParams(window.location.search);
      
      // Fetch latest property from API or local data
      const getLatestProperty = async () => {
        try {
          const res = await fetch('http://localhost:5001/api/properties');
          if (res.ok) {
            const props = await res.json();
            if (props[0]) {
              const p = props[0];
              return { id: p._id, name: p.name, category: p.type, price: p.price, bedrooms: p.bedrooms, 
                       bathrooms: p.bathrooms, area: p.area, floor: p.floor || 'N/A', parking: p.parking || 'N/A', 
                       image: p.image, description: p.description || '' };
            }
          }
        } catch (e) {}
        return window.propertyData?.properties?.[0] || {};
      };

      // Load property: from URL params or fetch latest
      let currentProperty;
      const hasParams = Array.from(params.keys()).length > 0;
      
      if (hasParams) {
        currentProperty = {
          id: params.get('id') || params.get('propertyId'),
          name: params.get('name'), category: params.get('category'), price: params.get('price'),
          bedrooms: params.get('bedrooms'), bathrooms: params.get('bathrooms'), area: params.get('area'),
          floor: params.get('floor'), parking: params.get('parking'), image: params.get('image'),
          description: params.get('description')
        };
        // Enrich missing data from local
        if (!currentProperty.id || !currentProperty.name) {
          const match = window.propertyData?.properties?.find(p => p.name === currentProperty.name) || window.propertyData?.properties?.[0];
          if (match) currentProperty = { ...match, ...currentProperty, id: currentProperty.id || match.id };
        }
      } else {
        currentProperty = await getLatestProperty();
      }

      // Ensure ID exists
      if (!currentProperty.id && currentProperty.name) {
        currentProperty.id = currentProperty.name.toLowerCase().replace(/\s+/g, '-');
      }

      // Render details
      const set = (id, val, isHTML) => { const el = document.getElementById(id); if (el && val) isHTML ? el.innerHTML = val : el.textContent = val; };
      set('property-name', currentProperty.name);
      set('property-category', currentProperty.category);
      if (currentProperty.image) document.getElementById('property-image').src = 'assets/images/' + currentProperty.image;
      set('property-price-display', currentProperty.price);
      set('property-description', currentProperty.description, true);
      set('property-area', currentProperty.area ? currentProperty.area + '<br><span>Total Flat Space</span>' : null, true);
      set('property-bedrooms', currentProperty.bedrooms);
      set('property-bathrooms', currentProperty.bathrooms);
      set('property-area-display', currentProperty.area);
      set('property-floor', currentProperty.floor);
      set('property-parking', currentProperty.parking);
    })();
  </script>

  </body>
</html>
